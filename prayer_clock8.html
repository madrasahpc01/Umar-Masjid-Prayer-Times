<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mosque Display Screen</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    body {
        margin: 0;
        background: #f4f4f4;
        font-family: Arial, sans-serif;
        overflow: hidden;
    }

    /* HEADER */
    #header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px 30px;
        background: #006655;
        color: white;
        height: 12vh;
    }

    #header .logo {
        height: 70px;
        width: 70px;        /* Make it a square box */
        border-radius: 50%; /* Turn it into a circle */
        object-fit: cover;  /* Crop image nicely */
        border: 2px solid gold;
    }

    #header .title {
        font-size: 2.5rem;
        font-weight: bold;
        flex: 1;
        text-align: center;
    }

    /* Title + tagline stacked */
    .masjid-text {
      display: flex;
      flex-direction: column;
      line-height: 1.2;
    }

    /* Main title */
    .masjid-text h1 {
      font-size: 2.5rem;
      font-weight: bold;
      flex: 1;
      text-align: center;
      color: var(--primary);
      margin: 0;
    }
    /* Tagline */
    .masjid-text .tagline {
      font-size: 1.0rem;
      text-align: center;
      color: var(--dark);
      opacity: 0.8;
      margin-top: 3px;
    }
    #header .clock {
        font-size: 4rem;
        font-weight: bold;
        margin-right: 30px;
    }

    #header .dates {
        text-align: right;
        font-size: 1.2rem;
        line-height: 1.4rem;
    }

    /* MAIN CONTENT AREA */
    #main {
        display: flex;
        height: 70vh;
    }

    #content-box {
        width: 33%;
        background: #ffffff;
        padding: 20px;
        font-size: 1.8rem;
        overflow: hidden;
        border-right: 3px solid #ccc;
    }

    #video-box {
        width: 67%;
        background: black;
    }

    #video-box video {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    #slideshow {
        width: 100%;
        height: 100%;
        position: relative;
    }

    .slide {
        position: absolute;
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: center;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        transition: opacity 1.5s ease-in-out;
    }

    .slide.active {
        opacity: 1;
    }

    .slide-content {
        background: rgba(0, 0, 0, 0.6);
        padding: 40px;
        border-radius: 15px;
        text-align: center;
        color: white;
        max-width: 70%;
    }

    .slide-content h2 {
        font-size: 3rem;
        margin-bottom: 20px;
        color: gold;
    }

    .slide-content .verse {
        font-size: 2.2rem;
        font-style: italic;
        margin-bottom: 20px;
    }

    .slide-content ul {
        list-style-type: disc;
        font-size: 1.8rem;
        text-align: left;
    }

    /* ANNOUNCEMENT BAR */
    #announcement {
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 8vh;
        background: #222;
        color: #fff;
        display: flex;
        align-items: center;
        overflow: hidden;
        font-size: 2.0rem;
        font-weight: bold;
        padding-left: 0px;
    }
    #announcementText {
        white-space: nowrap;
        display: inline-block;
        opacity: 0;
    }

    @keyframes scroll-left {
        from {
            transform: translateX(100%);
            opacity: 1;
        }
        to {
            transform: translateX(-120%);
            opacity: 1;
        }
    }


    #fullscreen-controls {
        position: fixed;
        top: 10px;
        right: 10px;
        z-index: 9999;
        opacity: 1;
        transition: opacity 0.5s ease;
    }

    #fullscreen-controls.hidden {
        opacity: 0;
        pointer-events: none;
    }

    #fullscreen-controls button {
        padding: 8px 14px;
        font-size: 1rem;
        border: none;
        border-radius: 6px;
        background: #222;
        color: white;
        cursor: pointer;
    }

    #fullscreen-controls button:hover {
        background: #444;
    }

    #info-bar {
        width: 100%;
        height: 8vh; /* adjustable */
        background: linear-gradient(90deg, #0a0a0a, #1a1a1a, #0a0a0a); 
        color: white;
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 1.8rem;
        font-weight: 700;
        border-top: 2px solid #333;
        border-bottom: 2px solid #333;
    }
     
    #ramadanCountdown {
        opacity: 1;
        margin: 0;
        padding: 0;
        white-space: nowrap;
        transition: opacity 2.0s ease-in-out;
        /* match info-bar height */
        height: 8vh;
        line-height: 6vh;

        display: flex;
        align-items: center;
        justify-content: center;

        /* Ramadan glowing pulse */
        text-shadow:
            0 0 10px rgba(0,255,180,0.9),
            0 0 20px rgba(0,255,180,0.7),
            0 0 30px rgba(0,255,180,0.5);

        animation: pulseCenter 2.5s ease-in-out infinite;
    }

/* GLOW STYLES */
.suhoor-glow {
    color: #3b82f6; /* blue */
    text-shadow: 0 0 12px rgba(59,130,246,0.8);
}

.iftar-glow {
    color: #f97316; /* orange */
    text-shadow: 0 0 12px rgba(249,115,22,0.8);
}

/* FLASHING ALERT */
.flash-alert {
    animation: flash 1s infinite alternate;
}

@keyframes flash {
    from { opacity: 1; }
    to { opacity: 0.3; }
}

</style>


</head>

<body>

<!-- HEADER -->
<div id="header">
    <a href="index.html">
        <img src="logo.png" class="logo" alt="Logo">
    </a>

    <div class="masjid-text">
      <h1>UMAR MASJID PRAYER TIMES</h1>
      <p class="tagline">Serving the community with faith, education, and unity</p>
    </div>

    <div class="clock" id="clock">00:00:00</div>

    <div class="dates">
        <div id="gregorian-date">Loading...</div>
        <div id="hijri-date">Loading...</div>
        <div id="weatherBox">Loading weather...</div>
    </div>
</div>

<div id="fullscreen-controls">
    <button onclick="toggleFullscreen()">â›¶ Full Screen</button>
</div>

<!-- MAIN CONTENT -->
<div id="main">
    <div id="content-box">
        <iframe 
            src="PrayerTimesPanel.html" 
            style="width:100%; height:100%; border:none; overflow:hidden;">
        </iframe>
    </div>


    <div id="video-box">
    <div id="slideshow">

        <div class="slide active" style="background-image:url('slide1.png')">
            <div class="slide-content">
                <h2>ğŸŒ™ Ramadan Kareem</h2>
                <p class="verse">ÙŠÙÙ€Ù°Ù“Ø£ÙÙŠÙ‘ÙÙ‡ÙØ§ Ù±Ù„Ù‘ÙØ°ÙÙŠÙ†Ù Ø¡ÙØ§Ù…ÙÙ†ÙÙˆØ§ÛŸ ÙƒÙØªÙØ¨Ù Ø¹ÙÙ„ÙÙŠÙ’ÙƒÙÙ…Ù Ù±Ù„ØµÙ‘ÙÙŠÙØ§Ù…Ù ÙƒÙÙ…ÙØ§ ÙƒÙØªÙØ¨Ù Ø¹ÙÙ„ÙÙ‰ Ù±Ù„Ù‘ÙØ°ÙÙŠÙ†Ù Ù…ÙÙ† Ù‚ÙØ¨Ù’Ù„ÙÙƒÙÙ…Ù’ Ù„ÙØ¹ÙÙ„Ù‘ÙÙƒÙÙ…Ù’ ØªÙØªÙ‘ÙÙ‚ÙÙˆÙ†Ù</p>
                <ul>
                    <li>O believers! Fasting is prescribed for you</li>
                    <li>As it was for those before you</li>
                    <li>So perhaps you will become mindful Ë¹of AllahËº</li>
                </ul>
                <h1>ğŸ“– Verse 183 â€” Surah Alâ€‘Baqarah</h1>
            </div>
        </div>

        <div class="slide" style="background-image:url('slide2.png')">
            <div class="slide-content">
                <h2>â­ Importance of Ramadan</h2>
                <p class="verse">Ø´ÙÙ‡Ù’Ø±Ù Ø±ÙÙ…ÙØ¶ÙØ§Ù†Ù Ù±Ù„Ù‘ÙØ°ÙÙ‰Ù“ Ø£ÙÙ†Ø²ÙÙ„Ù ÙÙÙŠÙ‡Ù Ù±Ù„Ù’Ù‚ÙØ±Ù’Ø¡ÙØ§Ù†Ù Ù‡ÙØ¯Ù‹Û­Ù‰ Ù„Ù‘ÙÙ„Ù†Ù‘ÙØ§Ø³Ù ÙˆÙØ¨ÙÙŠÙ‘ÙÙ†ÙÙ€Ù°ØªÙÛ¢ Ù…Ù‘ÙÙ†Ù Ù±Ù„Ù’Ù‡ÙØ¯ÙÙ‰Ù° ÙˆÙÙ±Ù„Ù’ÙÙØ±Ù’Ù‚ÙØ§Ù†Ù Ûš</p>
                <ul>
                    <li>Ramaá¸Ã¢n is the month in which the Quran was revealed</li>
                    <li>As a guide for humanity with clear proofs of guidance and the decisive authority</li>
                </ul>
                <h1>ğŸ“– Verse 185 â€” Surah Alâ€‘Baqarah</h1>
            </div>
        </div>

        <div class="slide" style="background-image:url('slide3.png')">
            <div class="slide-content">
                <h2>ğŸ•Œ The Month of Mercy</h2>
                <p class="verse"> Ø¹ÙÙ†Ù’ Ø£ÙØ¨ÙÙŠ Ù‡ÙØ±ÙÙŠÙ’Ø±ÙØ©ÙØŒ - Ø±Ø¶Ù‰ Ø§Ù„Ù„Ù‡ Ø¹Ù†Ù‡ - Ø£ÙÙ†Ù‘Ù Ø±ÙØ³ÙÙˆÙ„Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù ØµÙ„Ù‰ Ø§Ù„Ù„Ù‡ Ø¹Ù„ÙŠÙ‡ ÙˆØ³Ù„Ù… Ù‚ÙØ§Ù„Ù â€ "â€ Ø¥ÙØ°ÙØ§ Ø¬ÙØ§Ø¡Ù Ø±ÙÙ…ÙØ¶ÙØ§Ù†Ù ÙÙØªÙ‘ÙØ­ÙØªÙ’ Ø£ÙØ¨Ù’ÙˆÙØ§Ø¨Ù Ø§Ù„Ù’Ø¬ÙÙ†Ù‘ÙØ©Ù ÙˆÙØºÙÙ„Ù‘ÙÙ‚ÙØªÙ’ Ø£ÙØ¨Ù’ÙˆÙØ§Ø¨Ù Ø§Ù„Ù†Ù‘ÙØ§Ø±Ù ÙˆÙØµÙÙÙ‘ÙØ¯ÙØªÙ Ø§Ù„Ø´Ù‘ÙÙŠÙØ§Ø·ÙÙŠÙ†Ù â€"â€ â€.â€
</p>
                <ul>
                    <li>Abu Huraira reported Allah's Messenger (ï·º) as saying:</li>
                    <li>When the month of Ramadan comes</li>
                    <li>the gates of mercy are opened and the gates of Hell are locked</li>
                </ul>
                <h1>ğŸ“– Sahih Muslim â€” 107a</h1>
            </div>
        </div>

        <div class="slide" style="background-image:url('slide4.png')">
            <div class="slide-content">
                <h2>ğŸšªğŸšª Special Gate - Ar Raiyan</h2>
                <p class="verse"> Ø¥ÙÙ†Ù‘Ù ÙÙÙŠ Ø§Ù„Ù’Ø¬ÙÙ†Ù‘ÙØ©Ù Ø¨ÙØ§Ø¨Ù‹Ø§ ØŒ ÙŠÙÙ‚ÙØ§Ù„Ù Ù„ÙÙ‡Ù : Ø§Ù„Ø±Ù‘ÙÙŠÙ‘ÙØ§Ù†Ù ØŒ ÙŠÙØ¯Ù’Ø®ÙÙ„Ù Ù…ÙÙ†Ù’Ù‡Ù Ø§Ù„ØµÙ‘ÙØ§Ø¦ÙÙ…ÙÙˆÙ†Ù ÙŠÙÙˆÙ’Ù…Ù Ø§Ù„Ù’Ù‚ÙÙŠÙØ§Ù…ÙØ©Ù ØŒ Ù„ÙØ§ ÙŠÙØ¯Ù’Ø®ÙÙ„Ù Ù…ÙÙ†Ù’Ù‡Ù Ø£ÙØ­ÙØ¯ÙŒ ØºÙÙŠÙ’Ø±ÙÙ‡ÙÙ…Ù’ ØŒ ÙŠÙÙ‚ÙØ§Ù„Ù : Ø£ÙÙŠÙ’Ù†Ù Ø§Ù„ØµÙ‘ÙØ§Ø¦ÙÙ…ÙÙˆÙ†Ù ØŸ ÙÙÙŠÙÙ‚ÙÙˆÙ…ÙÙˆÙ†Ù ØŒ Ù„ÙØ§ ÙŠÙØ¯Ù’Ø®ÙÙ„Ù Ù…ÙÙ†Ù’Ù‡Ù Ø£ÙØ­ÙØ¯ÙŒ ØºÙÙŠÙ’Ø±ÙÙ‡ÙÙ…Ù’ ØŒ ÙÙØ¥ÙØ°ÙØ§ Ø¯ÙØ®ÙÙ„ÙÙˆØ§ Ø£ÙØºÙ’Ù„ÙÙ‚Ù ØŒ ÙÙÙ„ÙÙ…Ù’ ÙŠÙØ¯Ù’Ø®ÙÙ„Ù’ Ù…ÙÙ†Ù’Ù‡Ù Ø£ÙØ­ÙØ¯ÙŒ</p>
                <ul>
                    <li>TThere is a gate in Paradise called Ar-Raiyan</li>
                    <li>Those who observe fasts will enter through it on the Day of Resurrection and none except them will enter through it.'</li>
                    <li>After their entry the gate will be closed</li>
                </ul>
                <h1>ğŸ“– Sahih Bukhari â€” 1896 & Muslim â€” 1152</h1>
            </div>
        </div>

        <div class="slide" style="background-image:url('slide5.png')">
            <div class="slide-content">
                <h2>ğŸ¤² Fasting & Forgiveness</h2>
                <p class="verse">
                    Ù…ÙÙ†Ù’ Ù‚ÙØ§Ù…Ù Ù„ÙÙŠÙ’Ù„ÙØ©Ù Ø§Ù„Ù’Ù‚ÙØ¯Ù’Ø±Ù Ø¥ÙÙŠÙ…ÙØ§Ù†Ù‹Ø§ ÙˆÙØ§Ø­Ù’ØªÙØ³ÙØ§Ø¨Ù‹Ø§ ØºÙÙÙØ±Ù Ù„ÙÙ‡Ù Ù…ÙØ§ ØªÙÙ‚ÙØ¯Ù‘ÙÙ…Ù Ù…ÙÙ†Ù’ Ø°ÙÙ†Ù’Ø¨ÙÙ‡ÙØŒ ÙˆÙÙ…ÙÙ†Ù’ ØµÙØ§Ù…Ù Ø±ÙÙ…ÙØ¶ÙØ§Ù†Ù Ø¥ÙÙŠÙ…ÙØ§Ù†Ù‹Ø§ ÙˆÙØ§Ø­Ù’ØªÙØ³ÙØ§Ø¨Ù‹Ø§ ØºÙÙÙØ±Ù Ù„ÙÙ‡Ù Ù…ÙØ§ ØªÙÙ‚ÙØ¯Ù‘ÙÙ…Ù Ù…ÙÙ†Ù’ Ø°ÙÙ†Ù’Ø¨ÙÙ‡Ù
                </p>
                <ul>
                <li>Whoever established prayers on the night of Qadr</li>
                <li>Whoever fasts in the month of Ramadan out of sincere faith</li>
                <li>Hoping for a reward from Allah, then all his previous sins will be forgiven</li>
            </ul>
            <h1>ğŸ“– Sahih Bukhari â€” 1901</h1>
        </div>
    </div>  

        <div class="slide" style="background-image:url('slide4.png')">
            <div class="slide-content">
                <h2>ğŸ“– Laylatul Qadr</h2>
                <p class="verse">Ø¥ÙÙ†Ù‘ÙØ§Ù“ Ø£ÙÙ†Ø²ÙÙ„Ù’Ù†ÙÙ€Ù°Ù‡Ù ÙÙÙ‰ Ù„ÙÙŠÙ’Ù„ÙØ©Ù Ù±Ù„Ù’Ù‚ÙØ¯Ù’Ø±Ù - ÙˆÙÙ…ÙØ§Ù“ Ø£ÙØ¯Ù’Ø±ÙÙ‰Ù°ÙƒÙ Ù…ÙØ§ Ù„ÙÙŠÙ’Ù„ÙØ©Ù Ù±Ù„Ù’Ù‚ÙØ¯Ù’Ø±Ù - Ù„ÙÙŠÙ’Ù„ÙØ©Ù Ù±Ù„Ù’Ù‚ÙØ¯Ù’Ø±Ù Ø®ÙÙŠÙ’Ø±ÙŒÛ­ Ù…Ù‘ÙÙ†Ù’ Ø£ÙÙ„Ù’ÙÙ Ø´ÙÙ‡Ù’Ø±ÙÛ¢</p>
                <ul>
                    <li>Indeed, We sent this Ë¹QuranËº down on the Night of Glory</li>
                    <li>And what will make you realize what the Night of Glory is?</li>
                    <li>The Night of Glory is better than a thousand months</li>
                </ul>
                <h1>ğŸ“– Quran Chapter â€” 97 Surah Al Qadr</h1>
            </div>
        </div>

        <div class="slide" style="background-image:url('slide6.jpg')">
        </div>


    </div>
</div>


    
  </div>

    <div id="info-bar">
      <div class="row">
        <span class="left-glow" id="infoLeft">
            ğŸ“¢ Next Appeal: Jamia ul Uloom Multan on 28 Feb"
        </span>
      </div>

      <div id="suhoorIftarBox" style="font-size:1.8rem; font-weight:700; text-align:center;">
          Loading Suhoor & Iftar...
      </div>

    <div class="row">
        <span class="right-glow" id="infoRight">
            ğŸ’› Fitrana: Â£6 Per Person 
        </span>
    </div>
  </div>

  <!-- ANNOUNCEMENT BAR -->
  <div id="announcement">
      <div id="announcementText"></div>
  </div>

<script>
let state = {};  // FIXED

/* ===========================
   01. Digital Clock
   =========================== */
function updateClock() {
    const now = new Date();
    document.getElementById("clock").innerText = now.toLocaleTimeString();
}
setInterval(updateClock, 30000);
updateClock();

/* ===========================
   02. Gregorian Date
   =========================== */
document.getElementById("gregorian-date").innerText =
    new Date().toLocaleDateString("en-GB", { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

/* HIJRI DATE */
function updateHijri() {
    const today = new Date();
    const hijri = new Intl.DateTimeFormat("en-TN-u-ca-islamic", {
        day: "numeric",
        month: "long",
        year: "numeric"
    }).format(today);

    document.getElementById("hijri-date").innerText = hijri;
}
updateHijri();

/* ===========================
   SLIDESHOW ROTATION
=========================== */

let slideIndex = 0;
const slides = document.querySelectorAll(".slide");

function showSlides() {
    slides.forEach(slide => slide.classList.remove("active"));
    slideIndex++;
    if (slideIndex > slides.length) { slideIndex = 1 }
    slides[slideIndex - 1].classList.add("active");
}

setInterval(showSlides, 10000); // Change every 10 seconds

/* ===========================
   03. Full Screen (Hybrid)
   =========================== */

const fsToggle = document.getElementById("fsToggle");
const fsIcon = document.getElementById("fsIcon");
const controls = document.getElementById("fullscreen-controls");

let hideTimeout;

/* FULLSCREEN TOGGLE */
function goFullscreen() {
    const elem = document.documentElement;

    if (elem.requestFullscreen) elem.requestFullscreen();
    else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
    else if (elem.msRequestFullscreen) elem.msRequestFullscreen();

    fsIcon.textContent = "âœ–"; 
    autoHideControls();
}

function exitFullscreen() {
    if (document.exitFullscreen) document.exitFullscreen();
    else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
    else if (document.msExitFullscreen) document.msExitFullscreen();

    fsIcon.textContent = "â›¶";
    showControls();
}

function toggleFullscreen() {
    !document.fullscreenElement ? goFullscreen() : exitFullscreen();
}

/* AUTO FULLSCREEN AFTER 10 SECONDS */
setTimeout(() => {
    if (!document.fullscreenElement) goFullscreen();
}, 10000);

/* AUTO RE-ENTER FULLSCREEN IF USER EXITS */
document.addEventListener("fullscreenchange", () => {
    if (!document.fullscreenElement) {
        showControls();
        fsIcon.textContent = "â›¶";

        setTimeout(() => {
            if (!document.fullscreenElement) goFullscreen();
        }, 2000);
    }
});

/* AUTO-HIDE CONTROLS */
function showControls() {
    controls.classList.remove("hidden");
    clearTimeout(hideTimeout);

    hideTimeout = setTimeout(() => {
        controls.classList.add("hidden");
    }, 5000);
}

function autoHideControls() {
    showControls();
}

/* SHOW CONTROLS ON MOUSE MOVE */
document.addEventListener("mousemove", showControls);

/* INITIAL HIDE */
showControls();

/* F11 OVERRIDE */
document.addEventListener("keydown", (e) => {
    if (e.key === "F11") {
        e.preventDefault();
        toggleFullscreen();
    }
});


/* ===========================
   RAMADAN SUHOOR & IFTAR TIMES
   =========================== */

const ramadanTimes = {
  1:  { suhoor: "05:40", iftar: "17:30" },
  2:  { suhoor: "05:38", iftar: "17:32" },
  3:  { suhoor: "05:36", iftar: "17:34" },
  4:  { suhoor: "05:34", iftar: "17:36" },
  5:  { suhoor: "05:32", iftar: "17:38" },
  6:  { suhoor: "05:30", iftar: "17:40" },
  7:  { suhoor: "05:28", iftar: "17:42" },
  8:  { suhoor: "05:26", iftar: "17:43" },
  9:  { suhoor: "05:24", iftar: "17:45" },
  10: { suhoor: "05:22", iftar: "17:47" },
  11: { suhoor: "05:20", iftar: "17:49" },
  12: { suhoor: "05:17", iftar: "17:51" },
  13: { suhoor: "05:15", iftar: "17:53" },
  14: { suhoor: "05:13", iftar: "17:55" },
  15: { suhoor: "05:11", iftar: "17:56" },
  16: { suhoor: "05:08", iftar: "17:58" },
  17: { suhoor: "05:06", iftar: "18:00" },
  18: { suhoor: "05:04", iftar: "18:02" },
  19: { suhoor: "05:01", iftar: "18:04" },
  20: { suhoor: "04:59", iftar: "18:05" },
  21: { suhoor: "04:57", iftar: "18:07" },
  22: { suhoor: "04:56", iftar: "18:07" },
  23: { suhoor: "04:55", iftar: "18:09" },
  24: { suhoor: "04:50", iftar: "18:13" },
  25: { suhoor: "04:48", iftar: "18:14" },
  26: { suhoor: "04:46", iftar: "18:16" },
  27: { suhoor: "04:43", iftar: "18:18" },
  28: { suhoor: "04:41", iftar: "18:20" },
  29: { suhoor: "04:38", iftar: "18:21" },
  30: { suhoor: "04:36", iftar: "18:23" }
};

/* ===========================
   UPDATE SUHOOR & IFTAR (NO COUNTDOWN)
   =========================== */

function updateSuhoorIftar() {
    const today = new Date();
    const ramadanDay = getRamadanDay(today);
    const box = document.getElementById("suhoorIftarBox");

    if (!ramadanDay || !ramadanTimes[ramadanDay]) {
        box.innerHTML = "ğŸŒ™ Ramadan timetable not active";
        return;
    }

    const { suhoor, iftar } = ramadanTimes[ramadanDay];

    box.innerHTML = `
        <span style="color:#3b82f6; text-shadow:0 0 10px rgba(59,130,246,0.7);">
            ğŸŒ™ Suhoor Ends: <strong>${suhoor}</strong>
        </span>
        &nbsp;&nbsp; | &nbsp;&nbsp;
        <span style="color:#f97316; text-shadow:0 0 10px rgba(249,115,22,0.7);">
            ğŸŒ… Iftar: <strong>${iftar}</strong>
        </span>
    `;
}

/* Ramadan start date */
function getRamadanDay(date) {
    const ramadanStart = new Date("2026-02-18"); // 1 Ramadan 2026
    const diff = date - ramadanStart;

    if (diff < 0) return null;

    const day = Math.floor(diff / (1000 * 60 * 60 * 24)) + 1;

    return day >= 1 && day <= 30 ? day : null;
}

updateSuhoorIftar();

/* ===========================
   04. Weather (safe)
   =========================== */
async function loadWeather() {
  try {
    const lat = state.coords.lat;
    const lon = state.coords.lon;

    const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
    const data = await res.json();

    const temp = data.current_weather.temperature;
    const wind = data.current_weather.windspeed;
    const code = data.current_weather.weathercode;

    const icons = {
      0:"â˜€ï¸",1:"ğŸŒ¤ï¸",2:"â›…",3:"â˜ï¸",
      45:"ğŸŒ«ï¸",48:"ğŸŒ«ï¸",
      51:"ğŸŒ¦ï¸",53:"ğŸŒ¦ï¸",55:"ğŸŒ¦ï¸",
      61:"ğŸŒ§ï¸",63:"ğŸŒ§ï¸",65:"ğŸŒ§ï¸",
      71:"â„ï¸",73:"â„ï¸",75:"â„ï¸",
      95:"â›ˆï¸",96:"â›ˆï¸",99:"â›ˆï¸"
    };

    const icon = icons[code] || "ğŸŒ¤ï¸";

    let tempColor = "#22c55e";
    if (temp <= 0) tempColor = "#3b82f6";
    else if (temp <= 10) tempColor = "#0ea5e9";
    else if (temp <= 20) tempColor = "#22c55e";
    else if (temp <= 30) tempColor = "#f59e0b";
    else tempColor = "#ef4444";

    const weatherEl = document.getElementById("weatherBox");
    if (weatherEl)
      weatherEl.innerHTML =
  `<div style="display:flex;align-items:center;gap:8px;font-size:18px;">
      <span>${icon}</span>
      <span style="font-size:16px;font-weight:600;color:${tempColor};Weather: ">${temp}Â°C</span>
      <span style="font-size:14px;opacity:0.8;">ğŸ’¨ ${wind} km/h â¬…ï¸ Weather</span>
   </div>`;

  } catch (err) {
    console.error("Weather error", err);
    const weatherEl = document.getElementById("weatherBox");
    if (weatherEl) weatherEl.textContent = "Weather unavailable";
  }
}

async function init() {
  state.coords = {
    lat: 52.47107996227851,
    lon: -2.0349574320927606
  };

  await loadWeather();
}

init(); // FIXED


/* ===========================
   ANNOUNCEMENT BAR (FIXED)
   =========================== */

const announcements = [
    "ğŸ•Œ Welcome to the Umar Masjid News & Updates â€” Please maintain silence ğŸ¤«",
    "ğŸ“¢ Ramadan Apeals: On Sat 28 Feb: Jamia ul Uloom Multan 2026",
    "ğŸ“¢ Ramadan Apeals: On Mon 02 Mar: Kashmir Widows and Orphans Appeal",
    "ğŸ“¢ Ramadan Apeals: On Wed 04 Mar: Imam Ali Aqdus Madrasa of Study",
    "ğŸ“¢ Ramadan Apeals: On Sat 07 Mar: Yemen Crisis Relief Appeal",
    "ğŸ“¢ Ramadan Apeals: On Mon 09 Mar: UK Project: Dawah, New Muslim Care & Quran Distribution",
    "ğŸ“¢ Ramadan Apeals: On Wed 11 Mar: UKIM Combined Masjid Appeal",
    "ğŸ“¢ Ramadan Apeals: On Fri 13 Mar: UK Project: UKIM Youth Appeal",
    "ğŸ“¢ Ramadan Apeals: On Sun 15 Mar: General Emergency Appeal (including Middle East Crisis-Gaza)",
    "ğŸ“¢ Ramadan Apeals: On Tue 17 Mar: Clean Water for All",
    "ğŸ¤² Jazakumullahu Khairan"
];

let announcementIndex = 0;
const announcementEl = document.getElementById("announcementText");

// Force clean animation restart (TV-safe)
function restartAnimation(el) {
    el.style.animation = "none";
    el.offsetHeight; // âš ï¸ forces reflow (CRITICAL)
    el.style.animation = "scroll-left 22s linear";
}

function showNextAnnouncement() {
    announcementEl.textContent = announcements[announcementIndex];
    announcementEl.style.opacity = "1";

    restartAnimation(announcementEl);

    announcementIndex = (announcementIndex + 1) % announcements.length;
}

// Run once immediately
showNextAnnouncement();

// Repeat forever (match animation duration)
setInterval(showNextAnnouncement, 23000);

// ===============================
// Ramadan Countdown (Weeks & Days)
// ===============================

// Set next Ramadan start date
const ramadanStart = new Date("2026-02-17T00:00:00");
const el = document.getElementById("ramadanCountdown");
let isFading = false; // prevents overlapping fades

function updateRamadanCountdown() {
    if (isFading) return;
    isFading = true;

    const now = new Date();
    let diff = ramadanStart - now;

    if (diff <= 0) {
        el.textContent = "ğŸŒ™ Ramadan Mubarak!";
        return;
    }

    // Total remaining days
    const totalDays = Math.floor(diff / (1000 * 60 * 60 * 24));

   // Convert to weeks & days
   const weeks = Math.floor(totalDays / 7);
   const days = totalDays % 7;

   function pluralize(value, singular, plural) {
       return value === 1 ? singular : plural;
   }

   const newText = `ğŸŒ™ Ramadan: ${weeks} ${pluralize(weeks, "Week", "Weeks")} ${days} ${pluralize(days, "Day", "Days")}`;


    // Fade out
    el.style.opacity = 0;

    // After fade-out completes, update text and fade in
    setTimeout(() => {
        el.innerHTML = newText;
        el.style.opacity = 1;

        setTimeout(() => {
            isFading = false;
        }, 1500);

    }, 2000);
}

/* ================================
   STOP ANIMATIONS WHEN NOT VISIBLE
   ============================= */

// Run every 6 seconds
setInterval(updateRamadanCountdown, 3000000);
updateRamadanCountdown();

document.addEventListener("visibilitychange", () => {
  if (document.hidden) {
    document.body.style.animationPlayState = "paused";
  } else {
    document.body.style.animationPlayState = "running";
  }
});

/* ===========================
   SAFETY AUTO-RELOAD (LG TV)
   =========================== */

// Reload page every 3 hours to prevent memory leak
setTimeout(() => {
  location.reload();
}, 3 * 60 * 60 * 1000); // 3 hours


</script>

</body>
</html>








