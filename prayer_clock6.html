<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mosque Display Screen</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    body {
        margin: 0;
        background: #f4f4f4;
        font-family: Arial, sans-serif;
        overflow: hidden;
    }

    /* HEADER */
    #header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px 30px;
        background: #003366;
        color: white;
        height: 12vh;
    }

    #header .logo {
        height: 60px;
    }

    #header .title {
        font-size: 2.5rem;
        font-weight: bold;
        flex: 1;
        text-align: center;
    }

    #header .clock {
        font-size: 4rem;
        font-weight: bold;
        margin-right: 30px;
    }

    #header .dates {
        text-align: right;
        font-size: 1.2rem;
        line-height: 1.4rem;
    }

    /* MAIN CONTENT AREA */
    #main {
        display: flex;
        height: 70vh;
    }

    #content-box {
        width: 33%;
        background: #ffffff;
        padding: 20px;
        font-size: 1.8rem;
        overflow: hidden;
        border-right: 3px solid #ccc;
    }

    #video-box {
        width: 67%;
        background: black;
    }

    #video-box video {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    /* ANNOUNCEMENT BAR */
    #announcement {
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 8vh;
        background: #222;
        color: #fff;
        display: flex;
        align-items: center;
        overflow: hidden;
        font-size: 2rem;
        font-weight: bold;
    }

    #announcement span {
        white-space: nowrap;
        display: inline-block;
        padding-left: 100%;
        animation: scroll-left 20s linear infinite;
    }

    @keyframes scroll-left {
        from { transform: translateX(0); }
        to { transform: translateX(-100%); }
    }

    #fullscreen-controls {
        position: fixed;
        top: 10px;
        right: 10px;
        z-index: 9999;
        opacity: 1;
        transition: opacity 0.5s ease;
    }

    #fullscreen-controls.hidden {
        opacity: 0;
        pointer-events: none;
    }

    #fullscreen-controls button {
        padding: 8px 14px;
        font-size: 1rem;
        border: none;
        border-radius: 6px;
        background: #222;
        color: white;
        cursor: pointer;
    }

    #fullscreen-controls button:hover {
        background: #444;
    }

</style>
</head>

<body>

<!-- HEADER -->
<div id="header">
    <img src="logo.png" class="logo" alt="Logo">

    <div class="title">UMAR MASJID PRAYER TIMES</div>

    <div class="clock" id="clock">00:00:00</div>

    <div class="dates">
        <div id="gregorian-date">Loading...</div>
        <div id="hijri-date">Loading...</div>
        <div id="weatherBox">Loading weather...</div>
    </div>
</div>

<div id="fullscreen-controls">
    <button onclick="toggleFullscreen()">â›¶ Full Screen</button>
</div>

<!-- MAIN CONTENT -->
<div id="main">
    <div id="content-box">
        <iframe 
            src="PrayerTimesPanel.html" 
            style="width:100%; height:100%; border:none; overflow:hidden;">
        </iframe>
    </div>


    <div id="video-box">
        <iframe 
            width="100%" 
            height="100%" 
            src="https://www.youtube.com/embed/M8dHFJF_4Rc?autoplay=1&mute=1&loop=1&playlist=M8dHFJF_4Rc&controls=0&modestbranding=1"
            frameborder="0"
            allow="autoplay; encrypted-media"
            allowfullscreen>
            playsinline>
        </iframe>
    </div>

<!-- ANNOUNCEMENT BAR -->
<div id="announcement">
    <span>Welcome to the Umar Masjid â€” Please maintain silence â€” Madrasah will resume on 7th January 2026 â€”  Next Upcoming Event in Madrasah: Isra Wal Mi'raj â€” Jazakumullahu Khairan</span>
</div>

<script>
let state = {};  // FIXED

/* ===========================
   01. Digital Clock
   =========================== */
function updateClock() {
    const now = new Date();
    document.getElementById("clock").innerText = now.toLocaleTimeString();
}
setInterval(updateClock, 1000);
updateClock();

/* ===========================
   02. Gregorian Date
   =========================== */
document.getElementById("gregorian-date").innerText =
    new Date().toLocaleDateString("en-GB", { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

/* HIJRI DATE */
function updateHijri() {
    const today = new Date();
    const hijri = new Intl.DateTimeFormat("en-TN-u-ca-islamic", {
        day: "numeric",
        month: "long",
        year: "numeric"
    }).format(today);

    document.getElementById("hijri-date").innerText = hijri;
}
updateHijri();

/* ===========================
   03. Full Screen
   =========================== */

let hideTimeout;

// FULLSCREEN TOGGLE
function toggleFullscreen() {
    if (!document.fullscreenElement) {
        openFullscreen();
    } else {
        closeFullscreen();
    }
}

function openFullscreen() {
    const elem = document.documentElement;
    if (elem.requestFullscreen) elem.requestFullscreen();
    else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
    else if (elem.msRequestFullscreen) elem.msRequestFullscreen();
}

function closeFullscreen() {
    if (document.exitFullscreen) document.exitFullscreen();
    else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
    else if (document.msExitFullscreen) document.msExitFullscreen();
}

// AUTO-HIDE CONTROLS
function showControls() {
    const controls = document.getElementById("fullscreen-controls");
    controls.classList.remove("hidden");

    clearTimeout(hideTimeout);
    hideTimeout = setTimeout(() => {
        controls.classList.add("hidden");
    }, 10000); // 10 seconds
}

// SHOW ON MOUSE MOVE
document.addEventListener("mousemove", showControls);

// INITIAL HIDE TIMER
showControls();

// KEYBOARD SHORTCUT (F11)
document.addEventListener("keydown", (e) => {
    if (e.key === "F11") {
        e.preventDefault();
        toggleFullscreen();
    }
});

/* ====================================
   04. Auto Fullscreen After 10 Seconds
   ================================= */

setTimeout(() => {
    if (!document.fullscreenElement) {
        openFullscreen();
    }
}, 10000); // 10 seconds

/* ===========================
   05. Weather (safe)
   =========================== */
async function loadWeather() {
  try {
    const lat = state.coords.lat;
    const lon = state.coords.lon;

    const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
    const data = await res.json();

    const temp = data.current_weather.temperature;
    const wind = data.current_weather.windspeed;
    const code = data.current_weather.weathercode;

    const icons = {
      0:"â˜€ï¸",1:"ğŸŒ¤ï¸",2:"â›…",3:"â˜ï¸",
      45:"ğŸŒ«ï¸",48:"ğŸŒ«ï¸",
      51:"ğŸŒ¦ï¸",53:"ğŸŒ¦ï¸",55:"ğŸŒ¦ï¸",
      61:"ğŸŒ§ï¸",63:"ğŸŒ§ï¸",65:"ğŸŒ§ï¸",
      71:"â„ï¸",73:"â„ï¸",75:"â„ï¸",
      95:"â›ˆï¸",96:"â›ˆï¸",99:"â›ˆï¸"
    };

    const icon = icons[code] || "ğŸŒ¤ï¸";

    let tempColor = "#22c55e";
    if (temp <= 0) tempColor = "#3b82f6";
    else if (temp <= 10) tempColor = "#0ea5e9";
    else if (temp <= 20) tempColor = "#22c55e";
    else if (temp <= 30) tempColor = "#f59e0b";
    else tempColor = "#ef4444";

    const weatherEl = document.getElementById("weatherBox");
    if (weatherEl)
      weatherEl.innerHTML =
  `<div style="display:flex;align-items:center;gap:8px;font-size:18px;">
      <span>${icon}</span>
      <span style="font-size:16px;font-weight:600;color:${tempColor};Weather: ">${temp}Â°C</span>
      <span style="font-size:14px;opacity:0.8;">ğŸ’¨ ${wind} km/h â¬…ï¸ Weather</span>
   </div>`;

  } catch (err) {
    console.error("Weather error", err);
    const weatherEl = document.getElementById("weatherBox");
    if (weatherEl) weatherEl.textContent = "Weather unavailable";
  }
}

async function init() {
  state.coords = {
    lat: 52.47107996227851,
    lon: -2.0349574320927606
  };

  await loadWeather();
}

init(); // FIXED

...
init(); // FIXED

/* ===========================
   06. Auto Refresh + Cache Bust
   =========================== */

setInterval(() => {
    const base = window.location.origin + window.location.pathname;
    const cacheBuster = "?v=" + Date.now();
    window.location.replace(base + cacheBuster);
}, 60 * 60 * 1000);

</script>

</body>

</html>



